#include <reg52.h>
#define BAUDRATE 9600
#define SYSCLK (12000000)
#define SMOD 0

void uart_init(void);
/////////////////////////////////////////////
void main()
{
	unsigned char temp;
	uart_init();
	
	while(1)
	{
		while(!RI);
		RI = 0;
		temp = SBUF;
		SBUF = temp;
		while(!TI);
		TI = 0;
	}
}
/////////////////////////////////////////////
void uart_init(void)
{
	SCON = 0x50;
	TMOD = ~0xf0;
	TMOD |= 0x20;
	if(SMOD)
	{
		PCON |= 0x80;
		TH1 = -((SYSCLK/BAUDRATE)/16/12) ;
	}
	else 
	{
		PCON &= 0x80;
		TH1 = -((SYSCLK/BAUDRATE)/32/12) ;
	}
	TL1 = TH1;
	TR1 = 1;
	ES = 0;
}